<% provide :title do %><%= t('budgets.investments.index.title') %>
<% end %>

<% content_for :canonical do %>
  <% if @heading.present? %>
    <%= render "shared/canonical",
               href: budget_investments_url(@budget,
                                            heading_id: @heading.id,
                                            filter: @current_filter) %>
  <% else %>
    <%= render "shared/canonical", href: budget_investments_url(@budget) %>
  <% end %>
<% end %>

<main id="budget-investments-main" class="main-indented-content">

  <%= render '/budgets/investments/header' %>

  <% if params[:search].present? || params[:advanced_search].present? %>
<!--    TODO: show results with search param -->
    <!--    TODO: search header -->
<!--    <div class="highlight no-margin-top margin-bottom">-->
<!--      <div class="row">-->
<!--        <div class="small-12 column">-->
<!--          <h2><%#= t("shared.search_results") %></h2>-->
<!--          <p>-->
            <%#= page_entries_info @investments %>
<!--            <%#= t("budgets.investments.index.search_results_html",-->
<!--                  count: @investments.size,-->
                  search_term: params[:search]) %>
<!--          </p>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
  <% end %>

  <!--  TODO: remove all this?-->
  <!--  <div class="row">-->
  <!--    <div id="budget-investments" class="budget-investments-list small-12 medium-9 column">-->

  <!--      <!--      TODO: I Don't even know what's this-->
  <%# if @current_filter == "unfeasible" %>
  <!--        <div class="small-12 margin-bottom">-->
  <!--          <h2><%#= t("budgets.investments.index.unfeasible") %>: <%#= @heading.name %></h2>-->
  <!--          <div class="callout primary margin">-->
  <%#= t("budgets.investments.index.unfeasible_text") %>
  <!--          </div>-->
  <!--        </div>-->
  <%# elsif @heading.present? %>
  <!--        <div class="row">-->
  <!--          <div class="small-12 column">-->
  <%#= render "view_mode" %>
  <!--          </div>-->
  <!--        </div>-->
  <%# end %>
  <!--    </div>-->

  <!--  </div>-->

  <div class="row">
    <h2 class="phase-title">Å½e oddani predlogi</h2>

    <!-- TODO: finish order links, hover on title, adjust text -->
    <%= render('shared/order_links', i18n_namespace: "budgets.investments.index") unless @current_filter == "unfeasible" %>

    <div>
      <%= render 'budgets/investments/categories' %>
      <% if @budget.headings.count > 1 %>
        <%= render 'budgets/investments/districts' %>
      <% end %>
    </div>

    <% @investments.each do |investment| %>
      <div class="budget-investments-list small-12 medium-3 large-3 column">
        <%= render partial: '/budgets/investments/investment',
                   locals: {
                     investment: investment,
                     investment_ids: @investment_ids,
                     investment_votes: @investment_votes,
                     ballot: @ballot
                   } %>
      </div>
    <% end %>

  </div>

  <div class="row">
    <%= paginate @investments %>
  </div>
</main>
